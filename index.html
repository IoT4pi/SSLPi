<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title>SSLPi by IoT4pi</title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1>SSLPi</h1>
        <h2>secure communication for the raspberry pi and several type of clients</h2>
        <a href="https://github.com/IoT4pi/SSLPi" class="button"><small>View project on</small> GitHub</a>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <p><img src="https://github.com/IoT4pi/SSLPi/blob/master/images/IoT4Pi_Logo.png" alt="IoT4pi"></p>

<h1>
<a id="sslpi" class="anchor" href="#sslpi" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>SSLPi</h1>

<p>secure communication for the raspberry pi and several type of clients.
The main focus is on easy installation and no need for any cloud service.
A direct communication between a raspberry pi an clients with the use of OpenSSL.
With the help of a configuration file you are able to implement your own applications onto the raspberry pi.</p>

<h2>
<a id="youll-find-a-german-translated-version-of-the-readme-at-wwwiot4picom-" class="anchor" href="#youll-find-a-german-translated-version-of-the-readme-at-wwwiot4picom-" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>You'll find a German translated Version of the ReadMe at <a href="http://www.iot4pi.com">www.iot4pi.com</a> .</h2>

<h3>
<a id="so-lets-get-started-with-the-installation" class="anchor" href="#so-lets-get-started-with-the-installation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>So let's get started with the installation:</h3>

<p>After downloading the IoT4pi-SSLPi-XXXX.tar.gz to your System (Raspberry pi) to any given directory 
and extract it with the command</p>

<pre><code>`$ tar -zxvf IoT4pi-SSLPi-XXXX.tar.gz`
</code></pre>

<p>this generate a directory IoT4pi-SSLPi-XXXX.
(The X will vary depending on the version you have downloaded)</p>

<p>Change into the directory with</p>

<pre><code>`$ cd IoT4pi-SSLPi-XXXX`
</code></pre>

<p>There you will see with "ls -l"</p>

<pre><code>pi@Mypi ~/SSLPi_VersX $ ls -l
drwxr-xr-x 2 pi pi  4096 Jan 27 13:12 app
drwxr-xr-x 2 pi pi  4096 Jan 27 13:12 Test
-rwxr-xr-x 1 pi pi  6656 Jan 27 14:23 Install.sh
-rw-r--r-- 1 pi pi  4923 Jan 27 15:30 ReadMe_Install
-rw-r--r-- 1 pi pi  4923 Jan 27 15:30 ReadMe_Config
-rw-r--r-- 1 pi pi  4923 Jan 27 15:30 SSLPi.cfg
-rw-r--r-- 1 pi pi 21557 Jan 27 15:24 SSLserverPi_VX.py
-rwxr-xr-x 1 pi pi   550 Jan 27 15:30 startSSLPi.sh
</code></pre>

<p>In the app directory are sample application, to show you how to configure 
the SSLPi to your own demands. </p>

<p>In the TestClient directory is a sample Python SSL Client 
You can use it and modify it to your own needs. 
It is tested to work together with SSLPi Server.</p>

<p>To start the installation type </p>

<p><code>$ sudo ./Install.sh</code></p>

<p>The script is going to proof if the prerequisite software is on your system.
It actually checks if the Python2.7 and OpenSSL is installed. 
If not, it will exit the install script and you have to install the missing software. </p>

<p>As an information: 
you can install OpenSSL with
     <code>$ sudo apt-get install openssl</code></p>

<p>you can install python with
    <code>$ sudo apt-get install python2.7</code>
But I do not think this will happen very often,because the Raspberry (&amp; Raspian) runs Python 2.7 out of the box</p>

<p>Next you will be asked for directory, where the SSLPi Server has to be installed. If you do not specify a 
directory, the default directory will be created. the default directory is 
<code>/home/pi/SSLPi/</code></p>

<p>Next type in where to install the certificates. The default directory is 
<code>/home/pi/SSLPi/Cert/</code></p>

<p>As a next step the script is creating the certificates. 
You have to type in a password three times. It has to be the same password, all the time. </p>

<p>Afterwards you are asked for several pieces of information.
*<em>One of the prompts will be for "Common Name (e.g., YOUR name)". It is important *</em>
that this field be filled in with the fully qualified domain name of the server to be protected by SSL.</p>

<pre><code>`Country Name (2 letter code) [GB]:DE`
`State or Province Name (full name) [Berkshire]:Bavaria`
`Locality Name (eg, city) [Newbury]:Munich`
`Organization Name (eg, company) [My Company Ltd]:IoT4pi`
`Organizational Unit Name (eg, section) []:Information Technology`
`!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!`
`!!!!!Common Name (eg, your name or your server's hostname) []:iot4pi.com !!!!!!!!`
`!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!`
`Email Address []:office@iot4pi`
`Please enter the following 'extra' attributes`
`to be sent with your certificate request`
`A challenge password []:`
`An optional company name []:`
</code></pre>

<p>If you have everything provided, the the script will finish successfully.
The server will now start automatically at the reboot of the Raspberry pi. 
Per default the server will listen at port 10023.</p>

<p>You can now proof that everything is running OK by:</p>

<pre><code>Testing if it starts at Boot with command 
        `$sudo crontab -l`
        `it should present a line like:`
        `@reboot sudo /home/pi/SSLPi/startSSLPi.sh &gt;&gt; /home/pi/SSLPi/log 2&gt;&amp;1`


after reboot you can test if the server is running with
        `$ ps aux | grep SSLserverPi`
        `this should bring something like`

        `root 2133 0.0  0.5  4592 2640 ?  S  08:49 0:00 sudo python /home/pi/SSLPi/SSLserverPi_VX.py`
</code></pre>

<p>You will find the Server application in the specified installation directory. In this directory there
will be the app directory with the sample scripts. 
The Certificates will be stored in the specified certification directory. There you will find</p>

<pre><code>`-rw-r--r-- 1 root root 1147 Jan 27 15:31 server.cer`
`-rw-r--r-- 1 root root 1679 Jan 27 15:30 server.key`
`-rw-r--r-- 1 root root 1751 Jan 27 15:30 server.orig.key`
`-rw-r--r-- 1 root root 1338 Jan 27 15:31 server.pem`
</code></pre>

<p>The file server.pem is the important file you will need for the clients. This file you have to copy and
provide your clients with it. This one is the key to establish a communication withe the server. 
Without it, the server would reject any communication attempt.  </p>

<h3>
<a id="after-you-have-successfully-installed-the-software-you-can-configure-the-sslserverpi" class="anchor" href="#after-you-have-successfully-installed-the-software-you-can-configure-the-sslserverpi" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>After you have successfully installed the software you can configure the SSLserverPi</h3>

<p>to your own needs. This has to be done with the File SSLPi.cfg. 
The configuration file SSLPi.cfg has to be stored in the same directory as the SSLserverPi_VersX.py.</p>

<p>The Configuration is separated in two sections. 
The section <strong>[SETUP]</strong> takes care of the global behavior of the server.
The section <strong>[APP_CALLS]</strong> is the part where you call your own applications on the 
Raspberry pi. To give you an idea how it is done, we provide you with a few APP Call's 
and the referring applications/scripts which are stored in the directory app. </p>

<p>Per default the server will listen at port 10023.
If you want to change the Port, go to the section [SETUP] 
and change the line 
    iPort:10023
Everything else can be left unchanged in section [SETUP], 
if you have installed the server with the Install.sh.</p>

<p>The section [APP_CALLS] takes care of the Configuration of the applications which
have to be proceeded by the Server. 
A call is initiated by a Command which is sent from the Client to the Server.
An App Call can consist of one or more commands of the the server. Therefore an APP_CAll has a special format.</p>

<p>The format of APP_CALLS configuration Line is specified like this:</p>

<p><code>No.     : Command_In ; Sequence # ; OS Command ; App+Path ; Type ; Success Return ; Arg 1 ; ..; Arg n</code></p>

<p>All entry have running Number and a Name called Command_In.
The Command_In is the command which could be called by a Client.
The Command_In is the name of the APP_CALL. 
An APP_CALL will sent by the Client to the Server by the Command_In String.
A Command_In/APP_CALL can have non or one Parameter !</p>

<p>Due to the fact that an APP_CALL can consist of more then on command, we have to specify in which order the commands have 
to be proceeded by the the server. This order is specified by the sequence number Sequence Number.</p>

<p>The Value of OS Command can only be True or False. In case of an OS Command the App+Path needs only the command.
The operating systems takes care of the rest.</p>

<p>The App+Path should be the full Path and Name of the Command, except a OS Command is used. 
<em>Test</em> is a special command, it is an internal command which will send a Test Message back to the Client. You also have to take
 care in the Type column using the <em>Test</em> command.</p>

<p>The Type is needed by the Server, because depending on the Command Type it has to be handled different. 
Following Types are defined:</p>

<pre><code>`Test Command (sends back Test message)         -- Value 0`
`Change Dir                                         -- Value 1`
`(with defined directory in Argument section)`
`Command without a return (like rm )            -- Value 2`
`Command with return (like ls or pwd)           -- Value 3`
`Command  handles the parameters, with return       -- Value 4`
`Command  handles the parameters, without return         -- Value 5`
`Command  handles the parameters,for Change Dir     -- Value 6  `
</code></pre>

<p>As you see there are already 7 types defined.
There are three groups. </p>

<pre><code>`1) Value 0: the Test command which is an internal Test Function`
`2) Value 1 to 3: are Commands which will be proceeded by the Server without a Parameter`
`3) Value 4 to 6: the command which has to handle the parameter which is sent by the Client  `
</code></pre>

<p>So, as already mentioned one APP_CALL (Command_In) can consist of more then one 
commands. If the APP_CALL (Command_In) is sent with one Parameter you have to 
define which command in the sequence will take care of this parameter.
See the configured examples in the SSLPi.cfg. </p>

<p>*<em>Info: *</em>
    All commands of one APP_CALL of a Client are proceeded in one run. 
    The server won't  interrupt to handle an other Client in-between.
    Therefore it is guaranteed that you can edit files, change directories 
    and set IO's in one APP_CALL.   </p>

<p>Success Return: specifies which values the the sever gets, if the launched command was successfully  processed.
Normally you will 0 or 1 but sometimes you can not predict what you  will get but you can define what you do not want to get. 
    <code>In this case use the Reply string {!} (= must NOT be) with return Value (for instance {!}ERROR).</code></p>

<p>The last column is for arguments. If a command should have an additional parameter, it is defined in the argument. 
    <code>For instance "ls -l" would be separated this way : "ls" into the App+Path column and "-l" as an argument.</code></p>
        </section>

        <aside id="sidebar">
          <a href="https://github.com/IoT4pi/SSLPi/zipball/master" class="button">
            <small>Download</small>
            .zip file
          </a>
          <a href="https://github.com/IoT4pi/SSLPi/tarball/master" class="button">
            <small>Download</small>
            .tar.gz file
          </a>

          <p class="repo-owner"><a href="https://github.com/IoT4pi/SSLPi"></a> is maintained by <a href="https://github.com/IoT4pi">IoT4pi</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
        </aside>
      </div>
    </div>

  
  </body>
</html>
